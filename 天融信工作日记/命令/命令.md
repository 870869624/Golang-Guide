```bash
goctl api swagger --api rest/ngedr.api --dir . --filename doc/ngedr

C:\Users\linrui\Documents\WXWork\1688856424867849\Cache\File\2025-06\goctl.exe rpc protoc ngedr.proto --go_out=. --go-grpc_out=. --zrpc_out=. --style=go_zero -m（生成 rpc 接口）

C:\Users\linrui\Documents\WXWork\1688856424867849\Cache\File\2025-06\goctl.exe rest go -api ./threat_response.api -dir ../../demo（生成 api 接口）

goctl.exe rpc protoc cleansvc.proto `  --go_out=.`
--go-grpc_out=. `  --zrpc_out=.`
--style=go_zero `  -m`
-I=".;F:\protoc\include"
```

# 安管：
```bash
kubectl edit cm agcbb-config -n sdsp 修改配置
```

```bash
更改配置，暴露端口
[root@node01 ~]# kubectl patch svc agcbb -n sdsp -p '{"spec":{"ports":[{"name":"nanomsg","port":15555,"targetPort":15555,"protocol":"TCP"}]}}'
service/agcbb patched (no change)
[root@node01 ~]# kubectl get svc agcbb -n sdsp -o yaml
apiVersion: v1
kind: Service
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      {"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"labels":{"app":"agcbb"},"name":"agcbb","namespace":"sdsp"},"spec":{"ports":[{"name":"agcbb-for-agah","nodePort":8084,"port":8084,"protocol":"TCP","targetPort":8084}],"selector":{"app":"agcbb"},"sessionAffinity":"None","type":"NodePort"}}
  creationTimestamp: "2025-10-25T11:19:51Z"
  labels:
    app: agcbb
  name: agcbb
  namespace: sdsp
  resourceVersion: "4573595"
  uid: d4657d7d-7fa7-4a8d-aaa7-8d51ad877748
spec:
  clusterIP: 10.43.19.151
  clusterIPs:
  - 10.43.19.151
  externalTrafficPolicy: Cluster
  internalTrafficPolicy: Cluster
  ipFamilies:
  - IPv4
  ipFamilyPolicy: SingleStack
  ports:
  - name: nanomsg
    nodePort: 3835
    port: 15555
    protocol: TCP
    targetPort: 15555
  - name: agcbb-for-agah
    nodePort: 8084
    port: 8084
    protocol: TCP
    targetPort: 8084
  selector:
    app: agcbb
  sessionAffinity: None
  type: NodePort
status:
  loadBalancer: {}
[root@node01 ~]# kubectl port-forward svc/agcbb 15555:15555 -n sdsp
Forwarding from 127.0.0.1:15555 -> 15555
Forwarding from [::1]:15555 -> 15555
```

# 镜像：
```bash
k3s ctr image pull docker-hub.cloud.top/aiop/cleansvc-arm64:latest -k -u che_zhilin:Czl@talent123（手动拉取镜像）
```

然后重启下
```bash
kubectl rollout restart deploy cleansvc -n sdsp
```

# 获取服务：
```bash
kubectl get svc -A
```

```bash
kubectl get services --all-namespaces
```

# 获取容器：kubectl -n sdsp get pod
```bash
kubectl get pods
```

```bash
kubectl get svc -n sdsp
```

```bash
kubuctl get svc -n topsec-topngdlp
```

## 获取mongo服务：
```bash
kubectl get pods --all-namespaces | grep mongo
```
# 进入 pods：
```bash
kubectl exec -it virt-launcher-clean-node01-hv4sn -- /bin/bash
```
```bash
kubectl exec -it -n sdsp mongo-7fb899fbbf-flgq8  -- /bin/bash
```
# mongo：

## 进入 mongo：
```bash
mongo -u admin -p 'Cloud@talent123!@#'
```

### 切换数据库:
```bash
use 数据库名
```

### 查看集合数据：
```bash
db.集合名称.find({"_id":ObjectId("68dba608b9215cd46fb12bf4")}).limit(10)
```
